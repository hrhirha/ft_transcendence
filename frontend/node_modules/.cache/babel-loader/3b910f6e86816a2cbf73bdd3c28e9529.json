{"ast":null,"code":"var _jsxFileName = \"/goinfre/abahdir/ft_transcendence/frontend/src/views/components/check_auth/auth_checker.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { get_me } from \"../../../controller/user/user\";\nimport { Loading } from \"../loading/loading\";\nimport { NavBar } from \"../navbar/navbar\";\nimport { Notif } from \"../notif/notif\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthChecker = _ref => {\n  _s();\n\n  let {\n    wrappedContent,\n    redirect\n  } = _ref;\n  const [loading, setLoading] = useState(true);\n  const [user, setUser] = useState(null);\n  const navigator = useNavigate();\n  const location = useLocation();\n  useEffect(() => {\n    (async () => {\n      try {\n        const me = await get_me();\n        setUser(me);\n        if (location.pathname != redirect) navigator(redirect);\n      } catch (err) {\n        if (location.pathname != \"/login\") navigator(\"/login\");\n      }\n\n      setLoading(false);\n    })();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(Notif, {\n    children: [loading && /*#__PURE__*/_jsxDEV(Loading, {\n      width: \"100vw\",\n      height: \"100vh\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 21\n    }, this), !loading && location.pathname != \"/login\" && /*#__PURE__*/_jsxDEV(NavBar, {\n      user: user\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 57\n    }, this), !loading && wrappedContent]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 32,\n    columnNumber: 13\n  }, this);\n};\n\n_s(AuthChecker, \"FkGcLCAA7Ib/pIiF+N0lum7ocK4=\", false, function () {\n  return [useNavigate, useLocation];\n});\n\n_c = AuthChecker;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthChecker\");","map":{"version":3,"names":["React","useEffect","useState","useLocation","useNavigate","get_me","Loading","NavBar","Notif","AuthChecker","wrappedContent","redirect","loading","setLoading","user","setUser","navigator","location","me","pathname","err"],"sources":["/goinfre/abahdir/ft_transcendence/frontend/src/views/components/check_auth/auth_checker.tsx"],"sourcesContent":["import { faBan } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { AxiosError } from \"axios\";\nimport React, { useEffect, useState } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { get_me, user_infos } from \"../../../controller/user/user\";\nimport { Loading } from \"../loading/loading\";\nimport { NavBar } from \"../navbar/navbar\";\nimport { Notif } from \"../notif/notif\";\n\nexport const AuthChecker:React.FC<{wrappedContent: React.ReactNode, redirect: string}> = ({wrappedContent, redirect}) => {\n    const [loading, setLoading] = useState<boolean>(true);\n    const [user, setUser] = useState<any>(null);\n    const navigator = useNavigate();\n    const location = useLocation();\n\n    useEffect(() =>  {\n        (async () => {\n            try {\n                const me: user_infos = await get_me();\n                setUser(me);\n                if (location.pathname != redirect)\n                    navigator(redirect);\n            }\n            catch(err: AxiosError | any) {\n                if (location.pathname != \"/login\")\n                    navigator(\"/login\");\n            }\n            setLoading(false);\n        })();\n    }, []);\n    return (<Notif>\n        {loading && <Loading width=\"100vw\" height=\"100vh\"/>}\n        {!loading && (location.pathname != \"/login\") && <NavBar user={user}/>}\n        {!loading && wrappedContent}\n    </Notif>);\n}"],"mappings":";;;AAGA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,kBAAzC;AACA,SAASC,MAAT,QAAmC,+BAAnC;AACA,SAASC,OAAT,QAAwB,oBAAxB;AACA,SAASC,MAAT,QAAuB,kBAAvB;AACA,SAASC,KAAT,QAAsB,gBAAtB;;AAEA,OAAO,MAAMC,WAAyE,GAAG,QAAgC;EAAA;;EAAA,IAA/B;IAACC,cAAD;IAAiBC;EAAjB,CAA+B;EACrH,MAAM,CAACC,OAAD,EAAUC,UAAV,IAAwBX,QAAQ,CAAU,IAAV,CAAtC;EACA,MAAM,CAACY,IAAD,EAAOC,OAAP,IAAkBb,QAAQ,CAAM,IAAN,CAAhC;EACA,MAAMc,SAAS,GAAGZ,WAAW,EAA7B;EACA,MAAMa,QAAQ,GAAGd,WAAW,EAA5B;EAEAF,SAAS,CAAC,MAAO;IACb,CAAC,YAAY;MACT,IAAI;QACA,MAAMiB,EAAc,GAAG,MAAMb,MAAM,EAAnC;QACAU,OAAO,CAACG,EAAD,CAAP;QACA,IAAID,QAAQ,CAACE,QAAT,IAAqBR,QAAzB,EACIK,SAAS,CAACL,QAAD,CAAT;MACP,CALD,CAMA,OAAMS,GAAN,EAA6B;QACzB,IAAIH,QAAQ,CAACE,QAAT,IAAqB,QAAzB,EACIH,SAAS,CAAC,QAAD,CAAT;MACP;;MACDH,UAAU,CAAC,KAAD,CAAV;IACH,CAZD;EAaH,CAdQ,EAcN,EAdM,CAAT;EAeA,oBAAQ,QAAC,KAAD;IAAA,WACHD,OAAO,iBAAI,QAAC,OAAD;MAAS,KAAK,EAAC,OAAf;MAAuB,MAAM,EAAC;IAA9B;MAAA;MAAA;MAAA;IAAA,QADR,EAEH,CAACA,OAAD,IAAaK,QAAQ,CAACE,QAAT,IAAqB,QAAlC,iBAA+C,QAAC,MAAD;MAAQ,IAAI,EAAEL;IAAd;MAAA;MAAA;MAAA;IAAA,QAF5C,EAGH,CAACF,OAAD,IAAYF,cAHT;EAAA;IAAA;IAAA;IAAA;EAAA,QAAR;AAKH,CA1BM;;GAAMD,W;UAGSL,W,EACDD,W;;;KAJRM,W"},"metadata":{},"sourceType":"module"}